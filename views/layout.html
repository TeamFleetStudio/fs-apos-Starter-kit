{# Automatically extends the right outer layout and also handles AJAX siutations #}

{% import 'fragments/header.html' as header %}
{% import 'fragments/footer.html' as footer %}

{% extends data.outerLayout %}
{% set title = data.piece.title or data.page.title %}
{% block title %}
  {{ data.global.title }}
  {% if not title %}
    {{ apos.log('Looks like you forgot to override the title block in a template that does not have access to an Apostrophe page or piece.') }}
  {% endif %}
{% endblock %}

{% block extraHead %}
  {# Brand Colors - Override SCSS variables #}
  {% if data.global.primaryColor or data.global.secondaryColor %}
    <style>
      {% if data.global.primaryColor %}
        :root {
          --primary-color: {{ data.global.primaryColor }};
        }
        .btn--primary,
        .my-form__submit {
          background: {{ data.global.primaryColor }} !important;
        }
        .highlight-primary {
          color: {{ data.global.primaryColor }} !important;
        }
        a {
          color: {{ data.global.primaryColor }};
        }
        body {
          color: {{ data.global.primaryColor }};
        }
        .form-control:focus {
          border-color: {{ data.global.primaryColor }};
        }
        input[type="checkbox"]:checked {
          background: {{ data.global.primaryColor }};
        }
        input[type="radio"]:checked {
          background-image: radial-gradient({{ data.global.primaryColor }} 40%, transparent calc(40% + 1px));
        }
      {% endif %}
      {% if data.global.secondaryColor %}
        :root {
          --secondary-color: {{ data.global.secondaryColor }};
        }
        .btn--secondary {
          background: {{ data.global.secondaryColor }} !important;
        }
        .highlight-secondary {
          color: {{ data.global.secondaryColor }} !important;
        }
      {% endif %}
    </style>
  {% endif %}
  {# Custom CSS from Global Settings #}
  {% if data.global.customCSS and data.global.customCSS.code %}
    <style>
      {{ data.global.customCSS.code | safe }}
    </style>
  {% endif %}
{% endblock %}

{% block beforeMain %}
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  {# Marketing fonts #}
  <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;1,700&family=Merriweather:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
  {% render header.navigationBar(data) %}
{% endblock %}

{% block main %}
  {#
    Usually, your page templates in the @apostrophecms/pages module will override
    this block. It is safe to assume this is where your page-specific content
    should go.
  #}
{% endblock %}

{% block afterMain %}
    {% render footer.footer(data) %}
{% endblock %}

{% block extraBody %}
  {# Custom JavaScript from Global Settings #}
  {% if data.global.customJavaScript and data.global.customJavaScript.code %}
  <script>
      {{ data.global.customJavaScript.code | safe }}
  </script>
  {% endif %}
{% endblock %}
